var X=Object.defineProperty;var T=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var W=(o,r,a)=>r in o?X(o,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[r]=a,_=(o,r)=>{for(var a in r||(r={}))Y.call(r,a)&&W(o,a,r[a]);if(T)for(var a of T(r))Z.call(r,a)&&W(o,a,r[a]);return o};var g=(o,r,a)=>new Promise((u,m)=>{var h=d=>{try{b(a.next(d))}catch(p){m(p)}},f=d=>{try{b(a.throw(d))}catch(p){m(p)}},b=d=>d.done?u(d.value):Promise.resolve(d.value).then(h,f);b((a=a.apply(o,r)).next())});import{F as ee,i as oe}from"./Form-CPeIhX5s.js";import{p as i,c as te,A as D,B as se,C as ae}from"./index-CXvLa8iJ.js";import{u as ne}from"./useForm-R8Bxs0x8.js";import{u as E}from"./useIcon-3FdG6QVw.js";import{l as z,ag as ie,m as v,p as F,R as V,Q as L,u as n,W as x,O as Q,U as S,V as C,a as w,e as B,b as le,d as re,M as y,T as ce}from"./vue-chunks-ApmF_VrE.js";import{c as de,t as ue}from"./element-plus-BmqQxCtl.js";const q=z({__name:"ActionButton",props:{showSearch:i.bool.def(!0),showReset:i.bool.def(!0),showExpand:i.bool.def(!1),visible:i.bool.def(!0),searchLoading:i.bool.def(!1),resetLoading:i.bool.def(!1)},emits:["search","reset","expand"],setup(o,{emit:r}){const a=r,{t:u}=te(),m=()=>{a("search")},h=()=>{a("reset")},f=()=>{a("expand")};return(b,d)=>{const p=ie("BaseButton");return v(),F(Q,null,[o.showSearch?(v(),V(p,{key:0,type:"primary",loading:o.searchLoading,icon:n(E)({icon:"vi-ep:search"}),onClick:m},{default:L(()=>[S(C(n(u)("common.query")),1)]),_:1},8,["loading","icon"])):x("",!0),o.showReset?(v(),V(p,{key:1,loading:o.resetLoading,plain:"",icon:n(E)({icon:"vi-ep:refresh-right"}),onClick:h},{default:L(()=>[S(C(n(u)("common.reset")),1)]),_:1},8,["loading","icon"])):x("",!0),o.showExpand?(v(),V(p,{key:2,icon:n(E)({icon:o.visible?"vi-ep:arrow-up":"vi-ep:arrow-down"}),text:"",onClick:f},{default:L(()=>[S(C(n(u)(o.visible?"common.shrink":"common.expand")),1)]),_:1},8,["icon"])):x("",!0)],64)}}}),ke=z({__name:"Search",props:{schema:{type:Array,default:()=>[]},isCol:i.bool.def(!1),labelWidth:i.oneOfType([String,Number]).def("auto"),layout:i.string.validate(o=>["inline","bottom"].includes(o)).def("inline"),buttonPosition:i.string.validate(o=>["left","center","right"].includes(o)).def("center"),showSearch:i.bool.def(!0),showReset:i.bool.def(!0),showExpand:i.bool.def(!1),expandField:i.string.def(""),inline:i.bool.def(!0),removeNoValueItem:i.bool.def(!0),model:{type:Object,default:()=>({})},searchLoading:i.bool.def(!1),resetLoading:i.bool.def(!1)},emits:["search","reset","register","validate"],setup(o,{expose:r,emit:a}){const u=o,m=a,h=w(!0),f=w(u.model),b=B(()=>{const e=n(c);let t=de(e.schema);if(e.showExpand&&e.expandField&&!n(h)){const s=D(t,l=>l.field===e.expandField);t.map((l,K)=>(K>=s?l.hidden=!0:l.hidden=!1,l))}return e.layout==="inline"&&(t=t.concat([{field:"action",formItemProps:{labelWidth:"0px",slots:{default:()=>y("div",null,[y(q,{showSearch:e.showSearch,showReset:e.showReset,showExpand:e.showExpand,searchLoading:e.searchLoading,resetLoading:e.resetLoading,visible:h.value,onExpand:N,onReset:M,onSearch:I},null)]),label:()=>y("span",null,[S("Â ")])}}}])),t}),{formRegister:d,formMethods:p}=ne(),{getElFormExpose:k,getFormData:O,getFormExpose:U}=p,$=w({}),R=w({}),c=B(()=>{const e=_({},u);return Object.assign(e,n(R)),e}),G=(e={})=>{R.value=Object.assign(n(R),e),$.value=e},j=w([]);le(()=>n(b),(...t)=>g(this,[...t],function*(e=[]){f.value=oe(e,n(f)),j.value=e}),{immediate:!0,deep:!0});const P=()=>g(this,null,function*(){const e=yield O();return n(c).removeNoValueItem?Object.keys(e).reduce((t,s)=>{const l=e[s];return se(l)||(ae(l)?Object.keys(l).length>0&&(t[s]=l):t[s]=l),t},{}):e}),I=()=>g(this,null,function*(){const e=yield k();yield e==null?void 0:e.validate(t=>g(this,null,function*(){if(t){const s=yield P();m("search",s)}}))}),M=()=>g(this,null,function*(){const e=yield k();e==null||e.resetFields();const t=yield P();m("reset",t)}),H=B(()=>({textAlign:n(c).buttonPosition})),N=()=>g(this,null,function*(){h.value=!n(h)}),A={getElFormExpose:k,setProps:G,setSchema:e=>{const{schema:t}=n(c);for(const s of t)for(const l of e)s.field===l.field&&ue(s,l.path,l.value)},setValues:(...t)=>g(this,[...t],function*(e={}){f.value=Object.assign(u.model,n(f),e);const s=yield U();s==null||s.setValues(e)}),delSchema:e=>{const{schema:t}=n(c),s=D(t,l=>l.field===e);s>-1&&t.splice(s,1)},addSchema:(e,t)=>{const{schema:s}=n(c);if(t!==void 0){s.splice(t,0,e);return}s.push(e)},getFormData:O};re(()=>{m("register",A)}),r(A);const J=(e,t,s)=>{m("validate",e,t,s)};return(e,t)=>(v(),F(Q,null,[y(n(ee),{model:f.value,"is-custom":!1,"label-width":c.value.labelWidth,"hide-required-asterisk":"",inline:c.value.inline,"is-col":c.value.isCol,schema:j.value,onRegister:n(d),onValidate:J},null,8,["model","label-width","inline","is-col","schema","onRegister"]),o.layout==="bottom"?(v(),F("div",{key:0,style:ce(H.value)},[y(q,{"show-reset":c.value.showReset,"show-search":c.value.showSearch,"show-expand":c.value.showExpand,"search-loading":c.value.searchLoading,"reset-loading":c.value.resetLoading,visible:h.value,onExpand:N,onReset:M,onSearch:I},null,8,["show-reset","show-search","show-expand","search-loading","reset-loading","visible"])],4)):x("",!0)],64))}});export{ke as _};
